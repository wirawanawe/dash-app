(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7800],{4386:(e,t,a)=>{Promise.resolve().then(a.bind(a,122))},122:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var l=a(5155),s=a(2115),i=a(6046),r=a(5037),n=a(6932);function c(e){let{clinic:t,onSubmit:a,onCancel:i}=e,[r,n]=(0,s.useState)({name:"",code:"",description:""}),[c,d]=(0,s.useState)({});(0,s.useEffect)(()=>{t&&n({name:t.name||"",code:t.code||"",description:t.description||""})},[t]);let o=e=>{let{name:t,value:a}=e.target;n({...r,[t]:a}),c[t]&&d({...c,[t]:null})},m=()=>{let e={};return r.name.trim()||(e.name="Nama klinik harus diisi"),r.code.trim()||(e.code="Kode klinik harus diisi"),d(e),0===Object.keys(e).length};return(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg mb-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4 text-black",children:t?"Edit Klinik":"Tambah Klinik Baru"}),(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),m()&&a(r)},children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Klinik"}),(0,l.jsx)("input",{type:"text",id:"name",name:"name",value:r.name,onChange:o,className:"w-full p-2 text-black border rounded-md ".concat(c.name?"border-red-500":"border-gray-300")}),c.name&&(0,l.jsx)("p",{className:"text-red-500 text-xs mt-1",children:c.name})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kode Klinik"}),(0,l.jsx)("input",{type:"text",id:"code",name:"code",value:r.code,onChange:o,className:"w-full p-2 text-black border rounded-md ".concat(c.code?"border-red-500":"border-gray-300")}),c.code&&(0,l.jsx)("p",{className:"text-red-500 text-xs mt-1",children:c.code})]}),(0,l.jsxs)("div",{className:"mb-4 md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi"}),(0,l.jsx)("textarea",{id:"description",name:"description",value:r.description,onChange:o,rows:"3",className:"w-full p-2 text-black border border-gray-300 rounded-md"})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,l.jsx)("button",{type:"button",onClick:i,className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400",children:"Batal"}),(0,l.jsx)("button",{type:"submit",className:"px-4 py-2 bg-[#E22345] text-white rounded-md hover:bg-red-600",children:t?"Update":"Simpan"})]})]})]})}var d=a(7006);function o(){var e;let t;(0,i.useRouter)();let{user:a}=(0,n.A)(),[o,m]=(0,s.useState)([]),[x,p]=(0,s.useState)(!0),[h,u]=(0,s.useState)(""),[b,g]=(0,s.useState)(""),[k,y]=(0,s.useState)({page:1,limit:10,total:0,totalPages:0}),[j,f]=(0,s.useState)(!1),[N,v]=(0,s.useState)(null),[w,C]=(0,s.useState)(!1),E=(0,s.useRef)(!1),S=(null==a?void 0:a.role)==="ADMIN"||(null==a?void 0:a.role)==="admin",A=(0,s.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if((!w||e||!(o.length>0))&&!E.current)try{E.current=!0,p(!0);let e=await fetch("/api/clinics?search=".concat(encodeURIComponent(h),"&page=").concat(k.page,"&limit=").concat(k.limit)),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to fetch clinics");t&&Array.isArray(t.data)?m(t.data):(console.error("Invalid data structure received:",t),m([])),y(e=>{var a,l;return{...e,total:(null===(a=t.pagination)||void 0===a?void 0:a.total)||0,totalPages:(null===(l=t.pagination)||void 0===l?void 0:l.totalPages)||1}}),C(!0)}catch(e){console.error("Error fetching clinics:",e),r.Ay.error("Gagal memuat data klinik"),m([])}finally{p(!1),E.current=!1}},[h,k.page,k.limit,o.length]),K=(0,s.useCallback)((e=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];A(e)},function(){for(var a=arguments.length,l=Array(a),s=0;s<a;s++)l[s]=arguments[s];clearTimeout(t),t=setTimeout(()=>e.apply(this,l),300)}),[A]);(0,s.useEffect)(()=>{a&&!w&&K()},[a,w,K]),(0,s.useEffect)(()=>{w&&(k.page>1||""!==h)&&K(!0)},[k.page,h,K,w]);let P=e=>{y(t=>({...t,page:e}))},T=e=>{v(e),f(!0)},D=async e=>{if(confirm("Anda yakin ingin menghapus klinik ini?"))try{let t=await fetch("/api/clinics/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),a=await t.json();if(!t.ok)throw Error(a.error||"Failed to delete clinic");r.Ay.success("Klinik berhasil dihapus"),K(!0)}catch(e){console.error("Error deleting clinic:",e),r.Ay.error(e.message||"Gagal menghapus klinik")}},F=async e=>{try{let t=N?"/api/clinics/".concat(N.id):"/api/clinics",a=N?"PUT":"POST",l=await fetch(t,{method:a,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)}),s=await l.json();if(!l.ok)throw Error(s.error||"Failed to save clinic");r.Ay.success(N?"Klinik berhasil diperbarui":"Klinik berhasil ditambahkan"),f(!1),K(!0)}catch(e){console.error("Error saving clinic:",e),r.Ay.error(e.message||"Gagal menyimpan klinik")}};return(0,l.jsx)(d.A,{children:(0,l.jsxs)("div",{className:"container mx-auto p-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-black",children:"Manajemen Klinik"}),S&&!j&&(0,l.jsx)("button",{onClick:()=>{v(null),f(!0)},className:"bg-[#E22345] text-white px-4 py-2 rounded-lg hover:bg-red-600",children:"Tambah Klinik"})]}),j&&S&&(0,l.jsx)(c,{clinic:N,onSubmit:F,onCancel:()=>f(!1)}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),u(b),y(e=>({...e,page:1}))},className:"flex",children:[(0,l.jsx)("input",{type:"text",placeholder:"Cari klinik...",value:b,onChange:e=>{g(e.target.value)},className:"p-2 border rounded-l-lg w-full text-black"}),(0,l.jsx)("button",{type:"submit",className:"bg-[#E22345] text-white px-4 py-2 rounded-r-lg hover:bg-red-600",children:"Cari"})]})}),x&&!w?(0,l.jsx)("div",{className:"text-center py-10",children:"Loading..."}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"No"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Kode"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Nama Klinik"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Deskripsi"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Tanggal Dibuat"}),S&&(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Aksi"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.length>0?o.map((e,t)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:(k.page-1)*k.limit+t+1}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:(0,l.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:e.code})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:e.name}),(0,l.jsx)("td",{className:"px-6 py-4 text-black",children:e.description}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:new Date(e.created_at).toLocaleDateString()}),S&&(0,l.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:[(0,l.jsx)("button",{onClick:()=>T(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Edit"}),(0,l.jsx)("button",{onClick:()=>D(e.id),className:"text-red-600 hover:text-red-900",children:"Hapus"})]})]},e.id)):(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:S?6:5,className:"px-6 py-4 text-center text-black",children:"Tidak ada data klinik"})})})]})}),k.totalPages>1&&(0,l.jsx)("div",{className:"flex justify-center mt-6",children:(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("button",{onClick:()=>P(1),disabled:1===k.page,className:"px-3 py-1 border rounded disabled:opacity-50",children:"<<"}),(0,l.jsx)("button",{onClick:()=>P(k.page-1),disabled:1===k.page,className:"px-3 py-1 border rounded disabled:opacity-50",children:"<"}),(0,l.jsxs)("span",{className:"px-3 py-1",children:["Halaman ",k.page," dari ",k.totalPages]}),(0,l.jsx)("button",{onClick:()=>P(k.page+1),disabled:k.page===k.totalPages,className:"px-3 py-1 border rounded disabled:opacity-50",children:">"}),(0,l.jsx)("button",{onClick:()=>P(k.totalPages),disabled:k.page===k.totalPages,className:"px-3 py-1 border rounded disabled:opacity-50",children:">>"})]})})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[6711,5037,1028,7316,8441,1517,7358],()=>t(4386)),_N_E=e.O()}]);