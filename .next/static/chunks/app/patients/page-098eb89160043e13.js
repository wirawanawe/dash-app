(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8773],{3259:(e,a,t)=>{Promise.resolve().then(t.bind(t,1679))},1679:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>m});var s=t(5155),r=t(2115),i=t(6046),l=t(8173),n=t.n(l),d=t(1536),c=t(5037),o=t(7006);function x(e){let{patients:a,onDelete:t,onRefresh:i}=e,[l,o]=(0,r.useState)(!1),x=async e=>{if(confirm("Apakah Anda yakin ingin menghapus pasien ini?")){o(!0);try{let a=await fetch("/api/patients/".concat(e),{method:"DELETE"});if(!a.ok){let e=await a.json();throw Error(e.error||"Gagal menghapus pasien")}c.Ay.success("Pasien berhasil dihapus"),i&&i()}catch(e){console.error("Error:",e),c.Ay.error(e.message)}finally{o(!1)}}},m=e=>new Date(e).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"});return(0,s.jsx)("div",{className:"overflow-x-auto ",children:(0,s.jsxs)("table",{className:"min-w-full bg-white rounded-lg",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"No. RM"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NIP"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NIK"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal Lahir"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jenis Kelamin"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Asuransi"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-200",children:a.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.mrn}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.name}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.nip}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.nik}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m(e.birthDate)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.gender}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.nip?"Karyawan PLN":"-"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)(n(),{href:"/patients/".concat(e.id),className:"text-blue-600 hover:text-blue-900",children:(0,s.jsx)(d.Ny1,{className:"h-5 w-5"})}),(0,s.jsx)(n(),{href:"/patients/".concat(e.id,"/edit"),className:"text-yellow-600 hover:text-yellow-900",children:(0,s.jsx)(d.uO9,{className:"h-5 w-5"})}),(0,s.jsx)("button",{onClick:()=>x(e.id),disabled:l,className:"text-red-600 hover:text-red-900 disabled:text-gray-400",children:(0,s.jsx)(d.qbC,{className:"h-5 w-5"})})]})})]},e.id))})]})})}function m(){(0,i.useRouter)();let[e,a]=(0,r.useState)([]),[t,n]=(0,r.useState)(!0),[m,h]=(0,r.useState)(""),[p,u]=(0,r.useState)(1),[g,y]=(0,r.useState)(0),[b,f]=(0,r.useState)({}),[j,w]=(0,r.useState)(10),N=async()=>{try{var e;n(!0);let t=await fetch("/api/patients?search=".concat(m,"&page=").concat(p,"&limit=").concat(j));if(!t.ok)throw Error("Gagal mengambil data pasien");let s=t.headers.get("content-type");if(!s||!s.includes("application/json"))throw Error("Invalid response format");let r=await t.json();if(!r.data)throw Error("Invalid data format");a(r.data),f(r.pagination||{}),y((null===(e=r.pagination)||void 0===e?void 0:e.totalPages)||0)}catch(e){console.error("Error:",e),c.Ay.error(e.message||"Terjadi kesalahan saat mengambil data"),a([]),f({}),y(0)}finally{n(!1)}};return(0,r.useEffect)(()=>{N()},[m,p,j]),(0,s.jsx)(o.A,{children:(0,s.jsxs)("div",{className:"container mx-auto px-4 pb-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Daftar Pasien"}),(0,s.jsxs)(l,{href:"/patients/new",className:"bg-[#E22345] text-white px-4 py-2 rounded-lg hover:bg-red-600 flex items-center",children:[(0,s.jsx)(d.OiG,{className:"mr-2"}),"Tambah Pasien"]})]}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"text",placeholder:"Cari pasien...",value:m,onChange:e=>{h(e.target.value),u(1)},className:"w-full px-4 py-2 rounded-lg text-black border focus:outline-none focus:ring-2 focus:ring-[#E22345] pl-10"}),(0,s.jsx)(d.KSO,{className:"absolute left-3 top-3 text-gray-400"})]})}),t?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-[#E22345]"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x,{patients:e,onRefresh:N}),(0,s.jsxs)("div",{className:"mt-6 mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-700",children:["Menampilkan ",(p-1)*j+1," -"," ",Math.min(p*j,b.total||0)," dari"," ",b.total||0," data"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("label",{htmlFor:"limit",className:"text-sm text-gray-700",children:"Data per halaman:"}),(0,s.jsxs)("select",{id:"limit",value:j,onChange:e=>{w(parseInt(e.target.value)),u(1)},className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-[#E22345] focus:border-transparent",children:[(0,s.jsx)("option",{value:5,children:"5"}),(0,s.jsx)("option",{value:10,children:"10"}),(0,s.jsx)("option",{value:25,children:"25"}),(0,s.jsx)("option",{value:50,children:"50"}),(0,s.jsx)("option",{value:100,children:"100"})]})]})]}),g>1&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("button",{onClick:()=>u(1),disabled:1===p,className:"p-2 rounded-md border border-gray-300 text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white",title:"Halaman pertama",children:(0,s.jsx)(d.X8f,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>u(p-1),disabled:1===p,className:"p-2 rounded-md border border-gray-300 text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white",title:"Halaman sebelumnya",children:(0,s.jsx)(d._Jj,{className:"w-4 h-4"})}),(0,s.jsx)("div",{className:"flex items-center gap-1",children:(()=>{if(g<=1)return[1];let e=[],a=[];for(let a=Math.max(2,p-2);a<=Math.min(g-1,p+2);a++)e.push(a);return g>0&&a.push(1),p-2>2&&a.push("..."),e.forEach(e=>{1!==e&&e!==g&&a.push(e)}),p+2<g-1&&a.push("..."),g>1&&a.push(g),a.filter((e,a,t)=>t.indexOf(e)===a)})().map((e,a)=>(0,s.jsx)("button",{onClick:()=>"number"==typeof e&&u(e),disabled:"..."===e,className:"px-3 py-2 rounded-md text-sm font-medium transition-colors ".concat(e===p?"bg-[#E22345] text-white border border-[#E22345]":"..."===e?"text-gray-400 cursor-default":"text-gray-700 border border-gray-300 hover:bg-gray-50"),children:e},a))}),(0,s.jsx)("button",{onClick:()=>u(p+1),disabled:p===g,className:"p-2 rounded-md border border-gray-300 text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white",title:"Halaman selanjutnya",children:(0,s.jsx)(d.X6T,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>u(g),disabled:p===g,className:"p-2 rounded-md border border-gray-300 text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white",title:"Halaman terakhir",children:(0,s.jsx)(d.eaw,{className:"w-4 h-4"})})]})]})]})]})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[6711,5037,1028,7316,8441,1517,7358],()=>a(3259)),_N_E=e.O()}]);