(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[289],{6815:(e,a,s)=>{Promise.resolve().then(s.bind(s,2810))},2810:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>c});var t=s(5155),r=s(2115),l=s(7006);function n(e){let{doctor:a,onSubmit:s,onCancel:l}=e,[n,i]=(0,r.useState)({name:"",specialist:"",license_number:"",phone:"",email:"",address:""}),[d,c]=(0,r.useState)({});(0,r.useEffect)(()=>{a&&i({name:a.name||"",specialist:a.specialist||"",license_number:a.license_number||"",phone:a.phone||"",email:a.email||"",address:a.address||""})},[a]);let o=e=>{let{name:a,value:s}=e.target;i({...n,[a]:s}),d[a]&&c({...d,[a]:null})},m=()=>{let e={};return n.name.trim()||(e.name="Nama dokter harus diisi"),n.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)&&(e.email="Format email tidak valid"),e};return(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4 text-black",children:a?"Edit Dokter":"Tambah Dokter Baru"}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a=m();if(Object.keys(a).length>0){c(a);return}s(n)},children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:["Nama Dokter ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:n.name,onChange:o,className:"w-full p-2 border rounded-md ".concat(d.name?"border-red-500":"border-gray-300")}),d.name&&(0,t.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.name})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"specialist",className:"block text-sm font-medium text-gray-700 mb-1",children:"Spesialis"}),(0,t.jsx)("input",{type:"text",id:"specialist",name:"specialist",value:n.specialist,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"license_number",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nomor SIP"}),(0,t.jsx)("input",{type:"text",id:"license_number",name:"license_number",value:n.license_number,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telepon"}),(0,t.jsx)("input",{type:"text",id:"phone",name:"phone",value:n.phone,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,t.jsx)("input",{type:"email",id:"email",name:"email",value:n.email,onChange:o,className:"w-full p-2 border rounded-md ".concat(d.email?"border-red-500":"border-gray-300")}),d.email&&(0,t.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.email})]}),(0,t.jsxs)("div",{className:"mb-4 md:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Alamat"}),(0,t.jsx)("textarea",{id:"address",name:"address",value:n.address,onChange:o,rows:"3",className:"w-full p-2 border border-gray-300 rounded-md"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,t.jsx)("button",{type:"button",onClick:l,className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400",children:"Batal"}),(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 bg-[#E22345] text-white rounded-md hover:bg-red-600",children:a?"Update":"Simpan"})]})]})]})}var i=s(5037),d=s(1536);function c(){let[e,a]=(0,r.useState)([]),[s,c]=(0,r.useState)(!1),[o,m]=(0,r.useState)(null),[x,h]=(0,r.useState)(!0),[u,p]=(0,r.useState)("");(0,r.useEffect)(()=>{b()},[]);let b=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{let s;h(!0);let t="/api/doctors";e&&(t+="?search=".concat(encodeURIComponent(e)));try{if(!(s=await fetch(t)).ok){let e=await s.json().catch(()=>({}));throw console.error("Server error:",s.status,e),Error("HTTP error! Status: ".concat(s.status,". ").concat(e.message||""))}}catch(e){console.error("Network error:",e),a([]),h(!1),e.message.includes("ER_ACCESS_DENIED_ERROR")||e.message.includes("ECONNREFUSED")?i.Ay.error("Database connection error. Please check MySQL credentials."):e.message.includes("500")?i.Ay.error("Server error: Database query failed. Please check server logs."):i.Ay.error("Tidak dapat terhubung ke server. Coba lagi nanti.");return}let r=await s.json();a(Array.isArray(r)?r:[]),h(!1)}catch(e){console.error("Error in fetchDoctors:",e),a([]),h(!1),i.Ay.error("Gagal mengambil data dokter")}},y=async e=>{try{let a=await fetch("/api/doctors"+(o?"/".concat(o.id):""),{method:o?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();throw Error(e.message||"Failed to save")}i.Ay.success(o?"Dokter berhasil diupdate":"Dokter berhasil ditambahkan"),c(!1),b()}catch(e){console.error("Error:",e),i.Ay.error(e.message||"Gagal menyimpan dokter")}},g=async e=>{if(confirm("Apakah Anda yakin ingin menghapus dokter ini?"))try{if(!(await fetch("/api/doctors/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete");i.Ay.success("Dokter berhasil dihapus"),b()}catch(e){console.error("Error:",e),i.Ay.error("Gagal menghapus dokter")}};return(0,t.jsx)(l.A,{children:(0,t.jsxs)("div",{className:"container mx-auto p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-black",children:"Manajemen Dokter"}),(0,t.jsx)("button",{onClick:()=>{m(null),c(!0)},className:"bg-[#E22345] text-white px-4 py-2 rounded-lg hover:bg-red-600",children:"Tambah Dokter"})]}),s&&(0,t.jsx)(n,{doctor:o,onSubmit:y,onCancel:()=>{m(null),c(!1)}}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),b(u)},className:"flex",children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)("input",{type:"text",placeholder:"Cari dokter...",value:u,onChange:e=>p(e.target.value),className:"w-full p-2 pl-10 border border-gray-300 rounded-lg"}),(0,t.jsx)(d.KSO,{className:"absolute left-3 top-3 text-gray-400"})]}),(0,t.jsx)("button",{type:"submit",className:"ml-2 bg-[#E22345] text-white px-4 py-2 rounded-lg hover:bg-red-600",children:"Cari"})]})}),x?(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#E22345]"})}):(0,t.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Nama"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Spesialis"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Nomor SIP"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Kontak"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Aksi"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===e.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:"5",className:"px-6 py-4 text-center text-gray-500",children:"Tidak ada data dokter"})}):e.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:e.name}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:e.specialist||"-"}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:e.license_number||"-"}),(0,t.jsxs)("td",{className:"px-6 py-4 text-black",children:[(0,t.jsx)("div",{children:e.phone||"-"}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:e.email||""})]}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:[(0,t.jsxs)("button",{onClick:()=>{m(e),c(!0)},className:"text-blue-600 hover:text-blue-900 mr-4",children:[(0,t.jsx)(d.uO9,{className:"inline mr-1"})," Edit"]}),(0,t.jsxs)("button",{onClick:()=>g(e.id),className:"text-red-600 hover:text-red-900",children:[(0,t.jsx)(d.qbC,{className:"inline mr-1"})," Hapus"]})]})]},e.id))})]})})]})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[6711,5037,1028,7316,8441,1517,7358],()=>a(6815)),_N_E=e.O()}]);