(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7437],{3235:(e,t,a)=>{Promise.resolve().then(a.bind(a,2255))},2255:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var r=a(5155),s=a(2115),l=a(5037);function n(e){let{examination:t,onSubmit:a,onCancel:n}=e,[i,o]=(0,s.useState)({visitId:"",icdId:"",bloodPressure:"",heartRate:"",temperature:"",weight:"",height:"",notes:""}),[c,d]=(0,s.useState)([]),[h,x]=(0,s.useState)([]),[m,u]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(p(),b(),t){var e,a;o({visitId:t.visitId.toString(),icdId:t.icdId.toString(),bloodPressure:t.bloodPressure||"",heartRate:t.heartRate||"",temperature:t.temperature||"",weight:(null===(e=t.weight)||void 0===e?void 0:e.toString())||"",height:(null===(a=t.height)||void 0===a?void 0:a.toString())||"",notes:t.notes||""})}},[t]);let p=async()=>{try{let e=await fetch("/api/visits");if(!e.ok)throw Error("Failed to fetch visits");let t=await e.json();d(Array.isArray(t)?t:[])}catch(e){console.error("Error:",e),l.Ay.error("Gagal mengambil data kunjungan"),d([])}},b=async()=>{try{let e=await fetch("/api/settings/icd");if(!e.ok)throw Error("Failed to fetch ICDs");let t=await e.json();x(Array.isArray(t)?t:[])}catch(e){console.error("Error:",e),l.Ay.error("Gagal mengambil data ICD"),x([])}},g=e=>{let{name:t,value:a}=e.target;o(e=>({...e,[t]:a}))},f=async e=>{e.preventDefault(),u(!0);try{await a(i)}catch(e){console.error("Error:",e)}finally{u(!1)}};return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4 text-black",children:t?"Edit Pemeriksaan":"Tambah Pemeriksaan"}),(0,r.jsxs)("form",{onSubmit:f,children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-black mb-2",children:"Kunjungan"}),(0,r.jsxs)("select",{name:"visitId",value:i.visitId,onChange:g,className:"w-full px-4 py-2 border text-black rounded-lg focus:outline-none focus:border-[#E22345]",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Pilih Kunjungan"}),c.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.patient.name," -"," ",new Date(e.createdAt).toLocaleDateString()]},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-black mb-2",children:"Diagnosa (ICD)"}),(0,r.jsxs)("select",{name:"icdId",value:i.icdId,onChange:g,className:"w-full px-4 py-2 border text-black rounded-lg focus:outline-none focus:border-[#E22345]",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Pilih ICD"}),Array.isArray(h)&&h.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," - ",e.disease]},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-black mb-2",children:"Tekanan Darah"}),(0,r.jsx)("input",{type:"text",name:"bloodPressure",value:i.bloodPressure,onChange:g,placeholder:"Contoh: 120/80 mmHg",className:"w-full px-4 py-2 border text-black rounded-lg focus:outline-none focus:border-[#E22345]",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-black mb-2",children:"Detak Jantung"}),(0,r.jsx)("input",{type:"text",name:"heartRate",value:i.heartRate,onChange:g,placeholder:"Contoh: 80 bpm",className:"w-full px-4 py-2 border text-black rounded-lg focus:outline-none focus:border-[#E22345]",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-black mb-2",children:"Suhu Tubuh"}),(0,r.jsx)("input",{type:"text",name:"temperature",value:i.temperature,onChange:g,placeholder:"Contoh: 36.5 \xb0C",className:"w-full px-4 py-2 border text-black rounded-lg focus:outline-none focus:border-[#E22345]",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-black mb-2",children:"Berat Badan (kg)"}),(0,r.jsx)("input",{type:"number",step:"0.1",name:"weight",value:i.weight,onChange:g,placeholder:"Contoh: 65.5",className:"w-full px-4 py-2 border text-black rounded-lg focus:outline-none focus:border-[#E22345]",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-black mb-2",children:"Tinggi Badan (cm)"}),(0,r.jsx)("input",{type:"number",step:"0.1",name:"height",value:i.height,onChange:g,placeholder:"Contoh: 170",className:"w-full px-4 py-2 border text-black rounded-lg focus:outline-none focus:border-[#E22345]",required:!0})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-black mb-2",children:"Catatan"}),(0,r.jsx)("textarea",{name:"notes",value:i.notes,onChange:g,className:"w-full px-4 py-2 border text-black rounded-lg focus:outline-none focus:border-[#E22345]",rows:3})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-4 mt-6",children:[(0,r.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 border text-black rounded-lg hover:bg-gray-100",children:"Batal"}),(0,r.jsx)("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-[#E22345] text-white rounded-lg hover:bg-red-600 disabled:bg-gray-400",children:m?"Menyimpan...":"Simpan"})]})]})]})}var i=a(7006);function o(){let[e,t]=(0,s.useState)([]),[a,o]=(0,s.useState)(!1),[c,d]=(0,s.useState)(null),[h,x]=(0,s.useState)(!0);(0,s.useEffect)(()=>{m()},[]);let m=async()=>{try{let e;x(!0);try{if(!(e=await fetch("/api/examinations")).ok){let t=await e.json().catch(()=>({}));throw console.error("Server error:",e.status,t),Error("HTTP error! Status: ".concat(e.status,". ").concat(t.message||""))}}catch(e){console.error("Network error:",e),t([]),x(!1),e.message.includes("ER_ACCESS_DENIED_ERROR")||e.message.includes("ECONNREFUSED")?l.Ay.error("Database connection error. Please check MySQL credentials."):e.message.includes("500")?l.Ay.error("Server error: Database query failed. Please check server logs."):l.Ay.error("Tidak dapat terhubung ke server. Coba lagi nanti.");return}try{let a=await e.json();t(Array.isArray(a)?a:[]),x(!1)}catch(e){console.error("JSON parsing error:",e),t([]),x(!1),l.Ay.error("Gagal memproses data dari server")}}catch(e){console.error("Error in fetchExaminations:",e),t([]),x(!1),l.Ay.error("Gagal mengambil data pemeriksaan")}},u=async e=>{try{if(!(await fetch("/api/examinations"+(c?"/".concat(c.id):""),{method:c?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to save");l.Ay.success(c?"Pemeriksaan berhasil diupdate":"Pemeriksaan berhasil ditambahkan"),o(!1),m()}catch(e){console.error("Error:",e),l.Ay.error("Gagal menyimpan pemeriksaan")}},p=async e=>{if(confirm("Apakah Anda yakin ingin menghapus pemeriksaan ini?"))try{if(!(await fetch("/api/examinations/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete");l.Ay.success("Pemeriksaan berhasil dihapus"),m()}catch(e){console.error("Error:",e),l.Ay.error("Gagal menghapus pemeriksaan")}};return(0,r.jsx)(i.A,{children:(0,r.jsxs)("div",{className:"container mx-auto p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-black",children:"Data Pemeriksaan"}),(0,r.jsx)("button",{onClick:()=>{d(null),o(!0)},className:"bg-[#E22345] text-white px-4 py-2 rounded-lg hover:bg-red-600",children:"Tambah Pemeriksaan"})]}),a&&(0,r.jsx)(n,{examination:c,onSubmit:u,onCancel:()=>o(!1)}),h?(0,r.jsx)("p",{children:"Loading..."}):(0,r.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Tanggal"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Pasien"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Dokter"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Tekanan Darah"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Detak Jantung"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Suhu"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"BB/TB"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Aksi"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:new Date(e.createdAt).toLocaleDateString()}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:e.visit.patient.name}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:e.visit.doctor.name}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:e.bloodPressure}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:e.heartRate}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:e.temperature}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:[e.weight,"/",e.height]}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:[(0,r.jsx)("button",{onClick:()=>{d(e),o(!0)},className:"text-blue-600 hover:text-blue-900 mr-4",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>p(e.id),className:"text-red-600 hover:text-red-900",children:"Hapus"})]})]},e.id))})]})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[6711,5037,1028,7316,8441,1517,7358],()=>t(3235)),_N_E=e.O()}]);