(()=>{var e={};e.id=7800,e.ids=[7800],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},79551:e=>{"use strict";e.exports=require("url")},80017:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=a(70260),r=a(28203),i=a(25155),l=a.n(i),n=a(67292),o={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let d=["",{children:["clinics",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,15246)),"/Volumes/Data-2/PHC/Project/dash-app/app/clinics/page.js"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,38301)),"/Volumes/Data-2/PHC/Project/dash-app/app/layout.js"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Volumes/Data-2/PHC/Project/dash-app/app/clinics/page.js"],p={require:a,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/clinics/page",pathname:"/clinics",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3486:(e,t,a)=>{Promise.resolve().then(a.bind(a,15246))},43654:(e,t,a)=>{Promise.resolve().then(a.bind(a,38115))},38115:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var s=a(45512),r=a(58009),i=a(79334),l=a(22403),n=a(47544);function o({clinic:e,onSubmit:t,onCancel:a}){let[i,l]=(0,r.useState)({name:"",code:"",description:""}),[n,o]=(0,r.useState)({}),d=e=>{let{name:t,value:a}=e.target;l({...i,[t]:a}),n[t]&&o({...n,[t]:null})},c=()=>{let e={};return i.name.trim()||(e.name="Nama klinik harus diisi"),i.code.trim()||(e.code="Kode klinik harus diisi"),o(e),0===Object.keys(e).length};return(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-black",children:e?"Edit Klinik":"Tambah Klinik Baru"}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),c()&&t(i)},children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Klinik"}),(0,s.jsx)("input",{type:"text",id:"name",name:"name",value:i.name,onChange:d,className:`w-full p-2 text-black border rounded-md ${n.name?"border-red-500":"border-gray-300"}`}),n.name&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:n.name})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kode Klinik"}),(0,s.jsx)("input",{type:"text",id:"code",name:"code",value:i.code,onChange:d,className:`w-full p-2 text-black border rounded-md ${n.code?"border-red-500":"border-gray-300"}`}),n.code&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:n.code})]}),(0,s.jsxs)("div",{className:"mb-4 md:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi"}),(0,s.jsx)("textarea",{id:"description",name:"description",value:i.description,onChange:d,rows:"3",className:"w-full p-2 text-black border border-gray-300 rounded-md"})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400",children:"Batal"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 bg-[#E22345] text-white rounded-md hover:bg-red-600",children:e?"Update":"Simpan"})]})]})]})}var d=a(52964);function c(){var e;let t;(0,i.useRouter)();let{user:a}=(0,n.A)(),[c,p]=(0,r.useState)([]),[m,x]=(0,r.useState)(!0),[u,h]=(0,r.useState)(""),[b,g]=(0,r.useState)(""),[j,y]=(0,r.useState)({page:1,limit:10,total:0,totalPages:0}),[f,k]=(0,r.useState)(!1),[v,N]=(0,r.useState)(null),[w,P]=(0,r.useState)(!1),C=(0,r.useRef)(!1),S=a?.role==="ADMIN"||a?.role==="admin",A=(0,r.useCallback)(async(e=!1)=>{if((!w||e||!(c.length>0))&&!C.current)try{C.current=!0,x(!0);let e=await fetch(`/api/clinics?search=${encodeURIComponent(u)}&page=${j.page}&limit=${j.limit}`),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to fetch clinics");t&&Array.isArray(t.data)?p(t.data):(console.error("Invalid data structure received:",t),p([])),y(e=>({...e,total:t.pagination?.total||0,totalPages:t.pagination?.totalPages||1})),P(!0)}catch(e){console.error("Error fetching clinics:",e),l.Ay.error("Gagal memuat data klinik"),p([])}finally{x(!1),C.current=!1}},[u,j.page,j.limit,c.length]),E=(0,r.useCallback)((e=(e=!1)=>{A(e)},function(...a){clearTimeout(t),t=setTimeout(()=>e.apply(this,a),300)}),[A]),_=e=>{y(t=>({...t,page:e}))},D=e=>{N(e),k(!0)},K=async e=>{if(confirm("Anda yakin ingin menghapus klinik ini?"))try{let t=await fetch(`/api/clinics/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),a=await t.json();if(!t.ok)throw Error(a.error||"Failed to delete clinic");l.Ay.success("Klinik berhasil dihapus"),E(!0)}catch(e){console.error("Error deleting clinic:",e),l.Ay.error(e.message||"Gagal menghapus klinik")}},T=async e=>{try{let t=v?`/api/clinics/${v.id}`:"/api/clinics",a=v?"PUT":"POST",s=await fetch(t,{method:a,headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(e)}),r=await s.json();if(!s.ok)throw Error(r.error||"Failed to save clinic");l.Ay.success(v?"Klinik berhasil diperbarui":"Klinik berhasil ditambahkan"),k(!1),E(!0)}catch(e){console.error("Error saving clinic:",e),l.Ay.error(e.message||"Gagal menyimpan klinik")}};return(0,s.jsx)(d.A,{children:(0,s.jsxs)("div",{className:"container mx-auto p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-black",children:"Manajemen Klinik"}),S&&!f&&(0,s.jsx)("button",{onClick:()=>{N(null),k(!0)},className:"bg-[#E22345] text-white px-4 py-2 rounded-lg hover:bg-red-600",children:"Tambah Klinik"})]}),f&&S&&(0,s.jsx)(o,{clinic:v,onSubmit:T,onCancel:()=>k(!1)}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),h(b),y(e=>({...e,page:1}))},className:"flex",children:[(0,s.jsx)("input",{type:"text",placeholder:"Cari klinik...",value:b,onChange:e=>{g(e.target.value)},className:"p-2 border rounded-l-lg w-full text-black"}),(0,s.jsx)("button",{type:"submit",className:"bg-[#E22345] text-white px-4 py-2 rounded-r-lg hover:bg-red-600",children:"Cari"})]})}),m&&!w?(0,s.jsx)("div",{className:"text-center py-10",children:"Loading..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"No"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Kode"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Nama Klinik"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Deskripsi"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Tanggal Dibuat"}),S&&(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-black uppercase",children:"Aksi"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:c.length>0?c.map((e,t)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:(j.page-1)*j.limit+t+1}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:(0,s.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:e.code})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:e.name}),(0,s.jsx)("td",{className:"px-6 py-4 text-black",children:e.description}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:new Date(e.created_at).toLocaleDateString()}),S&&(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-black",children:[(0,s.jsx)("button",{onClick:()=>D(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>K(e.id),className:"text-red-600 hover:text-red-900",children:"Hapus"})]})]},e.id)):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:S?6:5,className:"px-6 py-4 text-center text-black",children:"Tidak ada data klinik"})})})]})}),j.totalPages>1&&(0,s.jsx)("div",{className:"flex justify-center mt-6",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>_(1),disabled:1===j.page,className:"px-3 py-1 border rounded disabled:opacity-50",children:"<<"}),(0,s.jsx)("button",{onClick:()=>_(j.page-1),disabled:1===j.page,className:"px-3 py-1 border rounded disabled:opacity-50",children:"<"}),(0,s.jsxs)("span",{className:"px-3 py-1",children:["Halaman ",j.page," dari ",j.totalPages]}),(0,s.jsx)("button",{onClick:()=>_(j.page+1),disabled:j.page===j.totalPages,className:"px-3 py-1 border rounded disabled:opacity-50",children:">"}),(0,s.jsx)("button",{onClick:()=>_(j.totalPages),disabled:j.page===j.totalPages,className:"px-3 py-1 border rounded disabled:opacity-50",children:">>"})]})})]})]})})}},15246:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Volumes/Data-2/PHC/Project/dash-app/app/clinics/page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Volumes/Data-2/PHC/Project/dash-app/app/clinics/page.js","default")}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[5994,4763,8077,8531,4098,5132],()=>a(80017));module.exports=s})();